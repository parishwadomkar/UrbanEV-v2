<?xml version="1.0" ?>
<!DOCTYPE config SYSTEM "http://www.matsim.org/files/dtd/config_v2.dtd">
<config>

    <module name="ev">
        <param name="auxDischargeTimeStep" value="10"/>
        <param name="chargeTimeStep" value="5"/>
        <param name="chargersFile" value="chargers.xml"/>
        <param name="timeProfiles" value="true"/>
        <param name="vehiclesFile" value="1pct/evehicles1pct.xml"/>
    </module>

    <module name="urban_ev">
        <param name="parkingSearchRadius" value="500"/>
        <param name="defaultRangeAnxietyThreshold" value="0.2"/>
        <param name="vehicleTypesFile" value="vehicletypes.xml"/>
        <param name="rangeAnxietyUtility" value="-10"/>
        <param name="emptyBatteryUtility" value="-30"/>
        <param name="walkingUtility" value="-1"/>
        <param name="homeChargingUtility" value="0"/>
        <param name="socDifferenceUtility" value="-15"/>
        <param name="maxNumberSimultaneousPlanChanges" value="2"/>
        <param name="timeAdjustmentProbability" value="0.1"/>
        <param name="maxTimeFlexibility" value="600"/>
        <param name="generateHomeChargersByPercentage" value="false"/>
        <param name="homeChargerPercentage" value="80"/>
        <param name="defaultHomeChargerPower" value="11"/>
        <param name="generateWorkChargersByPercentage" value="false"/>
        <param name="workChargerPercentage" value="20"/>
        <param name="defaultWorkChargerPower" value="11"/>

        <!-- Charger Costs (OmkarP. 2025) -->
        <param name="homeChargingCost" value="2.5"/>
        <param name="workChargingCost" value="4.0"/>
        <param name="publicChargingCost" value="5.5"/>
        <param name="betaMoney" value="-0.05"/>            <!--- VoT ~100 SEK/hr; Remove Cost - 0.0 -->
        <param name="alphaScaleCost" value="1.0"/>         <!-- scaling param Cost -->
        <param name="enableSmartCharging" value="true"/>   <!-- Remove smart rescheduling- false -->
        <param name="alphaScaleTemporal" value="1.0"/>
        <param name="awarenessFactor" value="0.7"/>
        <param name="coincidenceFactor" value="0.3"/>
    </module>

    <module name="global">
        <param name="randomSeed" value="4711" />
        <param name="coordinateSystem" value="EPSG:3006" />
        <param name="numberOfThreads" value="8"/>
    </module>

    <module name="parallelEventHandling">
        <param name="numberOfThreads" value="1"/>
    </module>

    <module name="network">
        <param name="inputNetworkFile" value="got_network.xml.gz"/>
        <param name="timeVariantNetwork" value="false" />
        <param name="inputChangeEventsFile" value="null" />
    </module>

    <module name="plans">
        <param name="inputPlansFile" value="1pct/GOTplans_1pct7Days.xml"/>
    </module>

    <module name="transit">
        <param name="useTransit" value="false" />
        <param name="transitScheduleFile" value="transitSchedule.xml.gz" />
        <param name="vehiclesFile" value="outputVehiclesFile.xml" />
        <param name="transitModes" value="pt" />
    </module>

    <module name="controler">
        <param name="outputDirectory" value="output/1pct/03_Smart_172hrs" />
        <param name="overwriteFiles" value="deleteDirectoryIfExists" />
        <param name="firstIteration" value="0"/>
        <param name="lastIteration" value="60"/>
        <param name="eventsFileFormat" value="xml"/>
        <param name="mobsim" value="qsim"/>
        <param name="writeEventsInterval" value="50"/>
        <param name="writePlansInterval" value="50"/>
        <param name="routingAlgorithmType" value="FastAStarLandmarks" />
        <param name="createGraphs" value="true"/>
        <param name="writeTripsInterval" value="1"/>
    </module>

    <module name="qsim">
        <param name="startTime" value="00:00:00"/>
        <param name="endTime" value="172:00:00"/>
        <param name="flowCapacityFactor" value="0.1" />
        <param name="storageCapacityFactor" value="0.1" />
        <param name="snapshotperiod" value="01:00:00"/>
    </module>

    <module name="planCalcScore">
        <param name="learningRate" value="1.0"/>
        <param name="BrainExpBeta" value="2.0"/>
        <param name="writeExperiencedPlans" value="false"/>
        <param name="usingOldScoringBelowZeroUtilityDuration" value="false"/>

        <parameterset type="scoringParameters">
            <!-- Applies to all agents (both nonCriticalSOC and criticalSOC) -->
            <param name="subpopulation" value="null"/>
            <!-- Core utility scale (keep consistent with EV betaMoney scale if you calibrate) -->
            <param name="marginalUtilityOfMoney" value="1.0"/>

            <!-- Time-related utilities (per hour) -->
            <!-- performing: positive, time at activities is good -->
            <param name="performing" value="6.0"/>
            <!-- schedule delay: being late is costly, early departure usually 0 -->
            <param name="lateArrival" value="-18.0"/>
            <param name="earlyDeparture" value="0.0"/>
            <!-- waiting: generic waiting 0, PT waiting penalized separately if needed -->
            <param name="waiting" value="0.0"/>
            <param name="waitingPt" value="-6.0"/>
            <!-- small penalty for line switch in PT -->
            <param name="utilityOfLineSwitch" value="-1.0"/>

            <!--  Mode-specific utilities  -->
            <!-- CAR -->
            <parameterset type="modeParams">
                <param name="mode" value="car"/>
                <!-- ASC -->
                <param name="constant" value="0.0"/>
                <!-- distance utility (usually 0, distance cost via monetaryDistanceRate) -->
                <param name="marginalUtilityOfDistance_util_m" value="0.0"/>
                <!-- additional disutility of traveling on top of opportunity cost -->
                <param name="marginalUtilityOfTraveling_util_hr" value="-6.0"/>
                <!-- per-meter monetary cost; reduce to avoid double counting cost effects -->
                <param name="monetaryDistanceRate" value="-0.00002"/>
            </parameterset>

            <!-- PT -->
            <parameterset type="modeParams">
                <param name="mode" value="pt"/>
                <param name="constant" value="0.0"/>
                <param name="marginalUtilityOfDistance_util_m" value="0.0"/>
                <param name="marginalUtilityOfTraveling_util_hr" value="-6.0"/>
                <!-- no distance-based PT fare here; you can add it if needed -->
                <param name="monetaryDistanceRate" value="0.0"/>
            </parameterset>

            <!-- WALK -->
            <parameterset type="modeParams">
                <param name="mode" value="walk"/>
                <param name="constant" value="0.0"/>
                <param name="marginalUtilityOfDistance_util_m" value="0.0"/>
                <param name="marginalUtilityOfTraveling_util_hr" value="-6.0"/>
                <param name="monetaryDistanceRate" value="0.0"/>
            </parameterset>

            <!-- BIKE -->
            <parameterset type="modeParams">
                <param name="mode" value="bike"/>
                <param name="constant" value="0.0"/>
                <param name="marginalUtilityOfDistance_util_m" value="0.0"/>
                <param name="marginalUtilityOfTraveling_util_hr" value="-6.0"/>
                <param name="monetaryDistanceRate" value="0.0"/>
            </parameterset>

            <!--  Activity-specific parameters- “per-day typical durations” of each activity type  -->
            <!-- HOME -->
            <parameterset type="activityParams">
                <param name="activityType" value="home"/>
                <param name="priority" value="1.0"/>
                <!-- ~12h typical home duration per day -->
                <param name="typicalDuration" value="12:00:00"/>
                <param name="typicalDurationScoreComputation" value="relative"/>
            </parameterset>

            <!-- WORK -->
            <parameterset type="activityParams">
                <param name="activityType" value="work"/>
                <param name="priority" value="1.0"/>
                <!-- standard 8h work day -->
                <param name="typicalDuration" value="08:00:00"/>
                <param name="typicalDurationScoreComputation" value="relative"/>
            </parameterset>

            <!-- SCHOOL -->
            <parameterset type="activityParams">
                <param name="activityType" value="school"/>
                <param name="priority" value="1.0"/>
                <!-- slightly shorter than work -->
                <param name="typicalDuration" value="07:00:00"/>
                <param name="typicalDurationScoreComputation" value="relative"/>
            </parameterset>

            <!-- OTHER (shopping, leisure, etc.) -->
            <parameterset type="activityParams">
                <param name="activityType" value="other"/>
                <param name="priority" value="1.0"/>
                <!-- more flexible shorter stay -->
                <param name="typicalDuration" value="03:00:00"/>
                <param name="typicalDurationScoreComputation" value="relative"/>
            </parameterset>

            <!-- interactions if you want to be explicit -->
            <parameterset type="activityParams">
                <param name="activityType" value="car interaction"/>
                <param name="scoringThisActivityAtAll" value="false"/>
                <param name="typicalDuration" value="00:00:01"/>
                <param name="typicalDurationScoreComputation" value="relative"/>
            </parameterset>
            <parameterset type="activityParams">
                <param name="activityType" value="pt interaction"/>
                <param name="scoringThisActivityAtAll" value="false"/>
                <param name="typicalDuration" value="00:00:01"/>
                <param name="typicalDurationScoreComputation" value="relative"/>
            </parameterset>

            <!-- EV charging activity types created by UrbanEV -->
            <parameterset type="activityParams">
                <param name="activityType" value="home charging"/>
                <param name="scoringThisActivityAtAll" value="false"/>
                <param name="typicalDuration" value="00:00:01"/>
            </parameterset>

            <parameterset type="activityParams">
                <param name="activityType" value="work charging"/>
                <param name="scoringThisActivityAtAll" value="false"/>
                <param name="typicalDuration" value="00:00:01"/>
            </parameterset>

            <parameterset type="activityParams">
                <param name="activityType" value="school charging"/>
                <param name="scoringThisActivityAtAll" value="false"/>
                <param name="typicalDuration" value="00:00:01"/>
            </parameterset>

            <parameterset type="activityParams">
                <param name="activityType" value="other charging"/>
                <param name="scoringThisActivityAtAll" value="false"/>
                <param name="typicalDuration" value="00:00:01"/>
            </parameterset>

            <!-- Failed charging attempts -->
            <parameterset type="activityParams">
                <param name="activityType" value="home charging failed"/>
                <param name="scoringThisActivityAtAll" value="false"/>
                <param name="typicalDuration" value="00:00:01"/>
            </parameterset>

            <parameterset type="activityParams">
                <param name="activityType" value="work charging failed"/>
                <param name="scoringThisActivityAtAll" value="false"/>
                <param name="typicalDuration" value="00:00:01"/>
            </parameterset>

            <parameterset type="activityParams">
                <param name="activityType" value="school charging failed"/>
                <param name="scoringThisActivityAtAll" value="false"/>
                <param name="typicalDuration" value="00:00:01"/>
            </parameterset>

            <parameterset type="activityParams">
                <param name="activityType" value="other charging failed"/>
                <param name="scoringThisActivityAtAll" value="false"/>
                <param name="typicalDuration" value="00:00:01"/>
            </parameterset>
        </parameterset>
    </module>

    <module name= "strategy">
        <!-- fraction of iterations where innovative strategies are switched off.  Something like 0.8 should be good. -->
        <param name="fractionOfIterationsToDisableInnovation" value="0.8" />
        <!-- maximum number of plans per agent.  ``0'' means ``infinity''. -->
        <param name="maxAgentPlanMemorySize" value="5" />
        <parameterset type= "strategysettings">
            <param name= "strategyName" value= "SelectExpBeta"/>
            <param name= "weight" value= "0.7"/>
            <param name= "subpopulation" value= "nonCriticalSOC"/>
        </parameterset>
        <parameterset type= "strategysettings">
            <param name= "strategyName" value= "ChangeChargingBehaviour"/>
            <param name= "weight" value= "0.3"/>
            <param name= "subpopulation" value= "nonCriticalSOC"/>
        </parameterset>
        <parameterset type= "strategysettings">
            <param name= "strategyName" value= "SelectExpBeta"/>
            <param name= "weight" value= "0"/>
            <param name= "subpopulation" value= "criticalSOC"/>
        </parameterset>
        <parameterset type= "strategysettings">
            <param name= "strategyName" value= "ChangeChargingBehaviour"/>
            <param name= "weight" value= "1"/>
            <param name= "subpopulation" value= "criticalSOC"/>
        </parameterset>
    </module>
</config>
